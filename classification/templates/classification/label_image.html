{% extends 'annotationweb/base.html' %}

{% block title %} Label image {% endblock %}


{% block onload %}
{% if image_sequence %}
loadSequence(
    {{ image_sequence.id }},
    {{ image_sequence.nr_of_frames }},
    {{ frame_nr }},
    {%  if task.show_entire_sequence %}true{% else %}false{% endif %},
    {{ task.frames_before }},
    {{ task.frames_after }}
);
{% endif %}
{% endblock %}

{% block content %}
    <h2>Label the following image</h2>
    {{ number_of_labeled_images }} of {{ total_number_of_images}} images has been labeled ({{ percentage_finished }}%).<br />
    {% if image_sequence %}
    <div id="progressbar"><div class="progress-label">Loading...</div></div>
    <div id="sliderText">Drag the slider to view the other frames in the sequence:</div>
    <div id="slider"></div>
    {% endif %}
    <div id="actionButtons">
        {% if image_sequence %}
        <button id="goToTargetFrame">Go to target frame</button>
        {% endif %}
        <button onclick="javascript:window.location.href='{% url 'classification:undo_image_label' task.id %}'">Undo previous labeled image</button>
    </div>
    <form id="label-form" method="post" action="{% url 'classification:label_image'  task.id %}">
        <input type="hidden" value="{{ image.id }}" name="image_id" />
        {% csrf_token %}
        <div id="labelButtons">
            Assign one label to this image:<br>
            {% for label in labels %}
            <input type="submit" name="{{label.name}}" value="{{label.name}}" class="labelButton">
            {% endfor %}
        </div>
        {% if image_sequence %}
        <canvas id="canvas">Failed to show images. Canvas probably not supported in the browser.</canvas>
        {% else %}
        <img src="{% url 'show_image' image.id %}" alt="" width="512"/>
        {% endif %}
    </form>
{% endblock %}
